@using SynWebCRM.Security
@model SynWebCRM.Data.Estimate

@{
    ViewBag.Title = "Смета на разработку";
    if (!User.Identity.IsAuthenticated)
    {
        Layout = "_EstimateLayout.cshtml";
    }
}

<link href='/Content/estimate.print.css' rel='stylesheet' media='print' />

<style>
    h1{
        margin-top:0;
    }

    .estimate-logo {
        margin: 20px;
        white-space: nowrap;
    }

    .estimate-logo:hover{
        text-decoration: none;
    }

        .estimate-logo span {
            margin-left: 10px;
            color: #000;
            font-size: 30px;
            font-weight: 400;
            vertical-align: middle;
            letter-spacing: 1px;
        }
</style>


<div class="pull-right">


    <a href="http://synweb.ru/" class="estimate-logo">
        <img src="http://synweb.ru/Content/clientTemplate/images/logo-35.png" alt="SynWeb - разработка сайтов на заказ">
        <span>СИНВЕБ</span>
    </a>


</div>

<h1>@Model.Title</h1>
<h2>Смета на разработку</h2>


@if (Model.Items.Any())
{
    <table class="table">
        <tr>
            <th></th>
            <th>Цена, <i class="fa fa-rub"></i></th>
            <th>Часы</th>
            <th class="text-left">Комментарий</th>
        </tr>
        @foreach (var item in Model.Items)
        {
            <tr>
                <td>@item.Name</td>
                <td class="text-center nowrap">@item.Price.ToString("# ##0.00")</td>
                <td class="text-center">@item.DevelopmentHours</td>
                <td>@item.Description</td>
            </tr>
        }
    </table>
}


@if (!string.IsNullOrWhiteSpace(Model.Text))
{
    <div>
        @Html.Raw(Model.Text)
    </div>
}



<div>

    <dl class="dl-horizontal" style="font-size: 18px;">
        <dt @(Model.Discount != 0 ? "class=bold" : "")>
            Итог
        </dt>
        <dd @(Model.Discount != 0 ? "class=strikethrough" : "")>
            @Model.Total.ToString("# ##0.00") <i class="fa fa-rub"></i>
        </dd>
        @if (Model.Discount != 0)
        {
            <dt>
                Скидка
            </dt>
            <dd>
                @Html.DisplayFor(model => model.Discount)%
            </dd>

            <dt>
                Итог со скидкой
            </dt>
            <dd class="bold">
                @((Model.Total * (decimal)(1 - Model.Discount / 100.0)).ToString("# ##0.00")) <i class="fa fa-rub"></i>
            </dd>
        }
    </dl>
</div>

<small class="hidden-print">Чтобы распечатать смету, нажмите Ctrl+P</small>

@if (User.IsInRole(CRMRoles.Admin) || User.IsInRole(CRMRoles.Sales))
{
    <div>
        <a class="btn btn-link" href="/Estimates/Edit/@Model.EstimateId"><i class="fa fa-pencil"></i>&nbsp;Редактировать</a>
    </div>
}